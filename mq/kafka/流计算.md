## kafka流计算
- [基本概念](https://juejin.im/entry/59bf56ebf265da065d2b63fa)



### 基于kafka实时日志流成立平台流程

<img src="assets/image-20201107202242928.png" alt="image-20201107202242928" style="zoom:150%;" />

```
1 partitions have leader brokers without a matching listener
```

- 配置

  ```
  config/connect-distributed.properties
  
  bootstrap.servers=localhost:9092
  rest.host.name=localhost
  rest.port=8083
  ```

- 启动connector

  ```shell
  bin/connect-distributed.sh config/connect-distributed.properties
  ```

- 创建connector

  ```
  curl -H "Content-Type:application/json" -H "Accept:application/json" http://localhost:8083/connectors -X POST --data '{"name":"file-connector-nginx","config":{"connector.class":"org.apache.kafka.connect.file.FileStreamSourceConnector","file":"/usr/local/openresty/nginx/logs","tasks.max":"1","topic":"access_log"}}'
  ```

- 查看创建connector

  ```
  curl http://localhost:8083/connectors
  ```

- 查看对应的主题中是否有数据

  ```
  bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic os-check --from-beginning --property value.deserializer=org.apache.kafka.common.serialization.LongDeserializer --property print.key=true --property key.deserializer=org.apache.kafka.streams.kstream.TimeWindowedDeserializer --property key.deserializer.default.windowed.key.serde.inner=org.apache.kafka.common.serialization.Serdes\$StringSerde
  ```


### 基本概念

**流处理平台（Streaming System）是处理无限数据集（Unbounded Dataset）的数据处理引擎，而流处理是与批处理（Batch Processing）相对应的**

利用流处理快速地给出不那么精确的结果；另一方面，依托于批处理，最终实现数据一致性。这就是所谓的**Lambda 架构**

<img src="assets/image-20201110234432821.png" alt="image-20201110234432821" style="zoom:150%;" />

- 所谓的**微批化**，其实就是重复地执行批处理引擎来实现对无限数据集的处理。典型的微批化实现平台就是Spark Streaming。



### kafka Stream 与其他框架对比

- 应用部署
  - Kafka Streams 更倾向于将部署交给开发人员来做，而不是依赖于框架自己实现。

- 目前 Kafka Streams 只支持与 Kafka 集群进行交互，它没有提供开箱即用的外部数据源连接器。