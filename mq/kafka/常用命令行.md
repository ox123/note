### topic

- 查看topic信息 

  ```
  kafka-topics.sh --bootstrap-server localhost:9092 --describe --topic topic
  ```

- 修改分区数

  ```
  bin/kafka-topics.sh --bootstrap-server localhost:9092 --alter --topic topic --partitions 2
  ```

-  修改主题级别参数

  ```
  bin/kafka-configs.sh --zookeeper zookeeper_host:port --entity-type topics --entity-name <topic_name> --alter --add-config max.message.bytes=10485760
  ```

- 查看topic内容

```
bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic __consumer_offsets --formatter "kafka.coordinator.group.GroupMetadataManager\$GroupMetadataMessageFormatter" --from-beginning
```



### 异常处理

##### 主题删除失败

1. 手动删除 ZooKeeper 节点 /admin/delete_topics 下以待删除主题为名的 znode。

2. 手动删除该主题在磁盘上的分区目录。

3. 在 ZooKeeper 中执行 rmr  /controller，触发 Controller 重选举，刷新 Controller 缓存。

##### **__consumer_offsets 占用太多的磁盘**

- 你一定要显式地用**jstack 命令**查看一下 kafka-log-cleaner-thread 前缀的线程状态。通常情况下，这都是因为该线程挂掉了，无法及时清理此内部主题。倘若真是这个原因导致的，那我们就只能重启相应的 Broker 了

