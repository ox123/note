### 查看你当前的内核版本
- uname -r

### 安装 Docker  
```yum -y install docker```

### 启动 Docker 后台服务
```service docker start```

### 测试运行 hello-world,由于本地没有hello-world这个镜像，所以会下载一个hello-world的镜像，并在容器内运行。
```docker run hello-world```
- 安装 nginx： ```docker run -d -p 91:80 nginx```
- 列出容器: ```docker ps```
- 查看容器日志： ```docker container logs bace029a464c```
- 进入容器：```docker exec -it f0b1c8ab3633 /bin/bash```
- 删除容器： ```docker rm f0b1c8ab3633```

### 常用操作
- 进入容器： docker exec -it image_id /bin/bash 
   - docker attach image_name
   - attach进入之后，如果是多个窗口，多个窗口会同步显示当前操作内容；
- 导出容器： docker export id > name.tar
- 导入容器： docker import id 

### 仓库
- ```docker run -d -p 5000:5000 registry  -v /opt/registry``` 文件默认保存在/tmp/registry目录下，-v参数值保存在指定的路径下
- 

### Dockerfile
- 组成部分： 基础镜像部分(FROM)，维护者信息(MAINTAINER)、镜像操作指令(RUN)和容器启动时执行指令(CMD)
```xml
FROM ubuntu // 指定的基础镜像
MAINTAINER docker_user docker_user@docker.com //指定维护者信息
// RUN指令为需要执行的操作
RUN echo "deb http://archive.ubuntu.com/ubuntu/ raring main universe" > /etc/apt/source.list
RUN  apt-get update && apt-get install -y nginx
RUN   echo "\ndaemon off;" >> /etc/nginx/nginx.conf
CMD /usr/sbin/nginx  // 容器启动时执行的指令
```
- ```EXPOSE 5900``` 堆外暴漏的访问端口,使用-p可以指定哪个本地端口映射过来。
- CMD 支持三种格式，每个容器只有一个CMD命令，如果指定多个，则只会执行最后一个。
  - CMD ["executable","parameter1","parameter2"] 使用exec执行，比较推荐方式
  - CMD command param1 param2 在/bin/sh 中执行，提供给需要交互的应用
  - CMD ["param1","param2"] 提供给ENTRYPOINT的默认参数
- ENV 指定一个环境变量，会被后续RUN指令使用，并在容器中运行时保持
```xml
ENV PG_MAJOR 9.3
RUN curl -SL http://example.com/postgre-$PG_MAJOR_version.tar.gz | tar -xJC /usr/src/postgress &&..
ENV PATH /usr/local/postgre-$PG_MAJOR/bin;$PATH
```
- ADD
  - 格式： ```ADD <src> <dest>```
  - 用于复制指定的src到容器的dest，其中src可以时Dockerfile所在目录的一个相对路径
- COPY
  - 格式： ```COPY src dest```
  - 复制本地主机src为容器中的dest，目标路径不存在时，会自动创建
  - 当使用本地目录为源目录时，推荐使用COPY
- ENTRYPOINT
  - 有两种格式
    1. ENTRYPOINT  ["prama1","prama2"]
    2. ENTRYPOINT  prama1 prama2  (shell中执行)
  - 每个Dockerfile中国只能有一个ENTRYPOINT，指定多个时，只有最后一个生效。
- VOLUME
  - 格式： ```VOLUME ["/data"]```
  - 创建一个可以从本地主机活其他容器挂载的挂载点，一般用来存放数据库和需要持久化的数据
- USER
  - 格式： ```USER daemon```
  - 指定容器运行时的用户名活UID，后续的RUN也会使用此用户。需要管理员权限可以使用gosu，不推荐使用sudo
  - 创建用户
    ```xml
    RUN groupadd -r postgres && useradd -r -g postgress postgress
    ```
- WORKDIR
  - 格式：```WORKDIR /PATH/TO/WORKDIR```